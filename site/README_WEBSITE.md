# 🌐 پنل مدیریت وب MeowVPN Bot

## 📋 معرفی

این پنل مدیریت وب کامل برای ربات VPN تلگرام طراحی شده است که تمامی قابلیت‌های ربات را در یک رابط کاربری زیبا و کاربردی ارائه می‌دهد.

## ✨ قابلیت‌های پنل

### 1. 📊 داشبورد اصلی
- نمایش آمار کامل کاربران (کل، فعال، مسدود، بازاریاب)
- نمایش آمار سرویس‌ها (کل، فعال، منقضی شده، در حال انقضا)
- نمایش آمار مالی (درآمد کل، درآمد ماهانه، تراکنش‌های در انتظار)
- نمایش آمار پلن‌ها، پنل‌ها، کارت‌های هدیه و کمیسیون‌ها
- نمودار درآمد 30 روز اخیر
- لیست آخرین کاربران و تراکنش‌ها

### 2. 👥 مدیریت کاربران
- مشاهده لیست کامل کاربران
- فیلتر بر اساس نقش (مشتری، بازاریاب، ادمین)
- فیلتر بر اساس وضعیت (فعال، مسدود)
- جستجوی کاربر بر اساس شناسه
- مشاهده جزئیات کامل هر کاربر
- مشاهده سرویس‌های کاربر
- مشاهده تراکنش‌های کاربر
- مشاهده افراد معرفی شده (برای بازاریاب‌ها)
- مشاهده کمیسیون‌ها (برای بازاریاب‌ها)
- تغییر وضعیت کاربر (فعال/مسدود)
- تغییر نقش کاربر
- افزایش/تنظیم موجودی کیف پول
- حذف کاربر

### 3. 🖥️ مدیریت سرویس‌ها
- مشاهده لیست کامل سرویس‌ها
- فیلتر بر اساس وضعیت (فعال، منقضی شده)
- فیلتر بر اساس پلن
- جستجوی سرویس بر اساس نام کاربری یا شناسه کاربر
- مشاهده جزئیات کامل سرویس
- مشاهده اطلاعات کاربر مرتبط
- مشاهده اطلاعات پلن مرتبط
- محاسبه روزهای باقیمانده
- فعال/غیرفعال کردن سرویس
- حذف سرویس

### 4. 📦 مدیریت پلن‌ها
- مشاهده لیست کامل پلن‌ها
- دسته‌بندی بر اساس category (عادی، ویژه، گیمینگ، ترید)
- نمایش تعداد سرویس‌های فعال و کل هر پلن
- افزودن پلن جدید
- ویرایش پلن موجود
- حذف پلن (فقط در صورت نداشتن سرویس فعال)
- تنظیمات: نام، دسته، مدت (روز), حجم (GB), قیمت، تعداد دستگاه

### 5. 🌐 مدیریت پنل‌ها
- مشاهده لیست کامل پنل‌ها (Marzban/Hiddify)
- افزودن پنل جدید
- ویرایش اطلاعات پنل
- فعال/غیرفعال کردن پنل
- حذف پنل
- تنظیمات: نام، نوع پنل، آدرس API، نام کاربری، رمز عبور

### 6. 💰 مدیریت تراکنش‌ها و مالی
- مشاهده لیست کامل تراکنش‌ها
- فیلتر بر اساس وضعیت (موفق، در انتظار، ناموفق)
- فیلتر بر اساس نوع (شارژ کیف پول، خرید سرویس، کارت هدیه)
- جستجوی تراکنش بر اساس کد پیگیری یا شناسه کاربر
- مشاهده جزئیات کامل تراکنش
- تایید تراکنش در انتظار
- رد تراکنش
- آمار کامل مالی (کل، موفق، در انتظار، ناموفق)

### 7. 📢 مدیریت بازاریاب‌ها و کمیسیون‌ها
- مشاهده لیست کامل بازاریاب‌ها
- نمایش آمار هر بازاریاب (تعداد معرفی‌ها، کمیسیون‌ها)
- مشاهده جزئیات کامل بازاریاب
- مشاهده لیست افراد معرفی شده
- مشاهده لیست کمیسیون‌ها
- تسویه حساب بازاریاب (پرداخت کمیسیون‌های پرداخت نشده)
- آمار کلی (کل بازاریاب‌ها، کل کمیسیون‌ها، کمیسیون‌های پرداخت نشده)

### 8. 🎁 مدیریت کارت‌های هدیه
- مشاهده لیست کامل کارت‌های هدیه
- فیلتر بر اساس وضعیت (استفاده شده، استفاده نشده)
- تولید کارت‌های هدیه جدید (تکی یا دسته‌جمعی تا 100 عدد)
- نمایش کد کارت‌های تولید شده
- حذف کارت‌های استفاده نشده
- آمار کامل (کل، استفاده شده، استفاده نشده، مبلغ کل)

### 9. 💳 مدیریت کارت‌های بانکی
- مشاهده لیست کامل کارت‌های بانکی
- افزودن کارت بانکی جدید
- ویرایش اطلاعات کارت
- فعال/غیرفعال کردن کارت
- تنظیم اولویت کارت
- تنظیم محدودیت روزانه
- ریست کردن مبلغ دریافتی روزانه
- نمایش ظرفیت باقیمانده
- حذف کارت
- تنظیمات: شماره کارت، نام دارنده، محدودیت روزانه، اولویت، یادداشت

### 10. ⚙️ تنظیمات
- تنظیمات کارت به کارت (شماره کارت، نام صاحب کارت)
- تنظیمات درگاه پرداخت (Merchant ID زرین‌پال)
- تنظیمات پشتیبانی (یوزرنیم پشتیبانی، آیدی کانال)
- تنظیمات اکانت تست (مدت، حجم)
- تنظیمات کمیسیون (درصد کمیسیون، حداقل مبلغ تسویه)
- تنظیمات پیام‌ها (پیام خوش‌آمدگویی، پیام موفقیت خرید، پیام انقضای سرویس)
- ذخیره و بازیابی تنظیمات

## 🛠️ فایل‌های ایجاد شده

### Controllers (در `/site/app/Http/Controllers/`)
1. `DashboardController.php` - کنترلر داشبورد اصلی
2. `UserController.php` - کنترلر مدیریت کاربران
3. `ServiceController.php` - کنترلر مدیریت سرویس‌ها
4. `PlanController.php` - کنترلر مدیریت پلن‌ها
5. `PanelController.php` - کنترلر مدیریت پنل‌ها
6. `TransactionController.php` - کنترلر مدیریت تراکنش‌ها
7. `MarketerController.php` - کنترلر مدیریت بازاریاب‌ها
8. `GiftCardController.php` - کنترلر مدیریت کارت‌های هدیه
9. `CardAccountController.php` - کنترلر مدیریت کارت‌های بانکی
10. `SettingController.php` - کنترلر تنظیمات

### Routes
- فایل `/site/routes/web.php` با تمام روت‌های لازم به‌روزرسانی شده

### Views (در `/site/resources/views/`)
- `dashboard/index.blade.php` - صفحه داشبورد اصلی با نمودار و آمار
- `users/index.blade.php` - لیست کاربران
- و دیگر صفحات در پوشه‌های مربوطه

## 🚀 نحوه استفاده

### 1. پیش‌نیازها
- PHP 8.0 یا بالاتر
- Composer
- Laravel 9.x یا بالاتر
- SQLite database (دیتابیس ربات در `/vpn_bot.db`)

### 2. نصب
```bash
cd site
composer install
php artisan key:generate
```

### 3. تنظیمات
- مطمئن شوید که فایل دیتابیس ربات (`vpn_bot.db`) در پوشه اصلی پروژه (`/workspace`) قرار دارد
- کنترلرها به صورت خودکار به دیتابیس ربات متصل می‌شوند

### 4. اجرا
```bash
# حالت توسعه
php artisan serve

# حالت production
# از Nginx یا Apache استفاده کنید
```

### 5. دسترسی
- آدرس پنل: `http://localhost:8000`
- صفحه اصلی به داشبورد redirect می‌شود

## 📱 صفحات و مسیرها

| مسیر | توضیحات |
|------|---------|
| `/` | داشبورد اصلی |
| `/users` | لیست کاربران |
| `/users/{userId}` | جزئیات کاربر |
| `/services` | لیست سرویس‌ها |
| `/services/{id}` | جزئیات سرویس |
| `/plans` | لیست پلن‌ها |
| `/plans/create` | افزودن پلن جدید |
| `/plans/{id}/edit` | ویرایش پلن |
| `/panels` | لیست پنل‌ها |
| `/panels/create` | افزودن پنل جدید |
| `/panels/{id}/edit` | ویرایش پنل |
| `/transactions` | لیست تراکنش‌ها |
| `/transactions/{id}` | جزئیات تراکنش |
| `/marketers` | لیست بازاریاب‌ها |
| `/marketers/{userId}` | جزئیات بازاریاب |
| `/gift-cards` | لیست کارت‌های هدیه |
| `/gift-cards/create` | تولید کارت هدیه |
| `/card-accounts` | لیست کارت‌های بانکی |
| `/card-accounts/create` | افزودن کارت بانکی |
| `/card-accounts/{id}/edit` | ویرایش کارت بانکی |
| `/settings` | تنظیمات |

## 🎨 قالب و طراحی

- استفاده از قالب RTL موجود در پوشه `site`
- قالب: Poco Admin Template
- Bootstrap 4
- RTL Layout برای زبان فارسی
- طراحی Responsive
- رنگ‌بندی: Primary, Success, Warning, Danger, Info
- آیکون‌ها: Font Awesome

## 🔐 امنیت

### توصیه‌های امنیتی:
1. **احراز هویت**: حتماً یک سیستم احراز هویت اضافه کنید (Laravel Auth)
2. **CSRF Protection**: فعال شده (Laravel پیش‌فرض)
3. **محافظت از دیتابیس**: فقط عملیات Read انجام می‌شود، Write محدود است
4. **Validation**: تمام ورودی‌ها Validate می‌شوند
5. **PDO**: استفاده از Prepared Statements برای جلوگیری از SQL Injection

## 📊 ویژگی‌های اضافی

### 1. نمودارها
- نمودار درآمد 30 روز اخیر (Chart.js)
- قابلیت گسترش برای نمودارهای بیشتر

### 2. فیلترها
- فیلتر پیشرفته در تمام صفحات
- جستجو
- فیلتر بر اساس وضعیت
- فیلتر بر اساس نوع

### 3. آمارگیری Real-time
- اتصال مستقیم به دیتابیس ربات
- به‌روزرسانی خودکار آمار

### 4. عملیات CRUD کامل
- Create (ایجاد)
- Read (خواندن)
- Update (ویرایش)
- Delete (حذف)

## 🔗 اتصال به ربات

دیتابیس مشترک بین وب‌سایت و ربات:
- ربات و وب‌سایت از یک دیتابیس SQLite استفاده می‌کنند
- تغییرات در وب‌سایت بلافاصله در ربات اعمال می‌شود
- تغییرات ربات بلافاصله در وب‌سایت نمایش داده می‌شود

## 📝 نکات مهم

1. **Path دیتابیس**: مطمئن شوید path صحیح دیتابیس در کنترلرها تنظیم شده (`base_path('../vpn_bot.db')`)
2. **Permissions**: دسترسی Read/Write به فایل دیتابیس نیاز است
3. **Backup**: قبل از هر تغییر مهم، حتماً Backup بگیرید
4. **Testing**: تمام عملیات را قبل از استفاده در محیط واقعی تست کنید

## 🚧 کارهای آتی (اختیاری)

- [ ] افزودن سیستم احراز هویت
- [ ] افزودن سیستم مجوزها (Permissions)
- [ ] افزودن لاگ فعالیت‌ها (Activity Log)
- [ ] افزودن گزارشات پیشرفته (Reports)
- [ ] افزودن نمودارهای بیشتر
- [ ] افزودن Export به Excel/PDF
- [ ] افزودن نوتیفیکیشن‌های Real-time
- [ ] افزودن Dark Mode
- [ ] افزودن چند زبانه (Multi-language)
- [ ] افزودن API برای اتصال خارجی

## 💡 نکات توسعه

### افزودن قابلیت جدید:
1. Controller جدید در `/site/app/Http/Controllers/` بسازید
2. Route در `/site/routes/web.php` اضافه کنید
3. View در `/site/resources/views/` بسازید
4. از قالب RTL موجود استفاده کنید (`@extends('layouts.rtl.master')`)

### استفاده از قالب:
```php
@extends('layouts.rtl.master')
@section('title', 'عنوان صفحه')

@section('breadcrumb-title')
    <h2>عنوان <span>صفحه</span></h2>
@endsection

@section('breadcrumb-items')
    <li class="breadcrumb-item">مسیر</li>
    <li class="breadcrumb-item active">صفحه فعلی</li>
@endsection

@section('content')
    <!-- محتوای صفحه -->
@endsection
```

## 📞 پشتیبانی

برای سوالات و مشکلات، به مستندات Laravel و قالب Poco مراجعه کنید.

## 📜 لایسنس

این پنل بخشی از پروژه MeowVPN Bot است و تحت لایسنس MIT منتشر شده است.

---

**ساخته شده با ❤️ برای جامعه ایرانی**
