# ๐ ุฑุงูููุง ุณุฑุน ูุงฺฏุฑุดู

ุงู ุฑุงูููุง ุจุฑุง ุงูุชูุงู ุณุฑุน ุฏุชุง ุงุฒ ุฑุจุงุช ูุฏู (Hiddify ููุท) ุจู ุฑุจุงุช ุฌุฏุฏ (Hiddify + Marzban).

## ๐ ุดุฑูุน ุณุฑุน (3 ูุฑุญูู)

### 1๏ธโฃ ุจฺฉุงูพ (ุถุฑูุฑ!)

```bash
# ุงุฌุฑุง ุงุณฺฉุฑูพุช ุจฺฉุงูพ
./backup_database.sh

# ุง ุจู ุตูุฑุช ุฏุณุช (SQLite):
cp bot_database.db bot_database.db.backup
```

### 2๏ธโฃ ุชุณุช ูุงฺฏุฑุดู

```bash
# ุชุณุช ุจุฏูู ุชุบุฑ ุฏุชุงุจุณ
python test_migration.py
```

### 3๏ธโฃ ูุงฺฏุฑุดู ฺฉุงูู

```bash
# ุงุฌุฑุง ูุงฺฏุฑุดู
python migrate_old_database.py
```

---

## ๐ ูุงูโูุง ููุฌูุฏ

| ูุงู | ุชูุถุญุงุช |
|------|---------|
| `migrate_old_database.py` | ุงุณฺฉุฑูพุช ุงุตู ูุงฺฏุฑุดู |
| `test_migration.py` | ุงุณฺฉุฑูพุช ุชุณุช (ุจุฏูู ุชุบุฑ ุฏุชุง) |
| `backup_database.sh` | ุงุณฺฉุฑูพุช ุจฺฉุงูพ ุฎูุฏฺฉุงุฑ |
| `MIGRATION_GUIDE.md` | ุฑุงูููุง ฺฉุงูู ู ุฌุฒุฆุงุช ูู |
| `demo.sql` | ุฏุชุงุจุณ ูุฏู (ุจุงุฏ ุฏุฑ ููู ุฏุงุฑฺฉุชูุฑ ุจุงุดุฏ) |

---

## โ ฺฺฉโูุณุช ูุจู ุงุฒ ุดุฑูุน

- [ ] ูุงู `demo.sql` ุฏุฑ ุฏุงุฑฺฉุชูุฑ ุฑุจุงุช ูุฑุงุฑ ุฏุงุฑุฏ
- [ ] ุงุฒ ุฏุชุงุจุณ ุฌุฏุฏ ุจฺฉุงูพ ฺฏุฑูุชู ุดุฏู
- [ ] ุชุณุช ูุงฺฏุฑุดู ุงุฌุฑุง ุดุฏู ู ูููู ุจูุฏู
- [ ] ุจู ุฏุณุชูุฑุงูุนููโูุง ุฏูุช ฺฉุฑุฏูโุงุฏ

---

## โ๏ธ ูฺฉุงุช ููู

### 1. ุงู ุงุณฺฉุฑูพุช ฺู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏุ

โ **ุงูุฌุงู ูโุฏูุฏ:**
- ุงูุชูุงู ฺฉุงุฑุจุฑุงู + ููุฌูุฏ ฺฉู ูพูู
- ุงูุชูุงู ูพููโูุง Hiddify
- ุงูุชูุงู ูพููโูุง (ุฏุณุชูโุจูุฏ ูุญุตููุงุช)
- ุงูุชูุงู ุณุฑูุณโูุง (ูุญุตููุงุช ุฎุฑุฏุงุฑ ุดุฏู)
- ุงูุชูุงู ุชุฑุงฺฉูุดโูุง

โ **ุงูุฌุงู ููโุฏูุฏ:**
- ูพุงฺฉ ฺฉุฑุฏู ุง ุชุบุฑ ุฏุชุงุจุณ ูุฏู
- ุชุบุฑ ุฏุชุง ููุฌูุฏ ุฏุฑ ุฏุชุงุจุณ ุฌุฏุฏ
- ุงูุชูุงู ุฎูุฏฺฉุงุฑ `referrer_id` (ูุงุฒ ุจู ฺฉูุฆุฑ ุฏุณุช)
- ุงูุชูุงู ฺฉูุณููโูุง (ูุงุฒ ุจู ุชูุณุนู ุงุถุงู)

### 2. ููุงุฑุฏ ูุงุฒููุฏ ุจุฑุฑุณ ุฏุณุช

ุจุนุฏ ุงุฒ ูุงฺฏุฑุดูุ ุงู ููุงุฑุฏ ุฑุง ฺฺฉ ฺฉูุฏ:

```sql
-- 1. ุจุฑุฑุณ ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู
SELECT COUNT(*) FROM users;

-- 2. ุจุฑุฑุณ ูุฌููุน ููุฌูุฏ ฺฉู ูพููโูุง
SELECT SUM(wallet_balance) FROM users;

-- 3. ุจุฑุฑุณ ูพููโูุง ูุนุงู
SELECT * FROM panels WHERE is_active = 1;

-- 4. ุจุฑุฑุณ ุณุฑูุณโูุง ูุนุงู
SELECT COUNT(*) FROM services WHERE is_active = 1;
```

### 3. Referrer_id ฺุทูุฑ ุชูุธู ุจุดูุ

ุจุนุฏ ุงุฒ ูุงฺฏุฑุดูุ ุงู ฺฉูุฆุฑ ุฑู ุงุฌุฑุง ฺฉูุฏ:

```sql
-- ุจูโุฑูุฒุฑุณุงู referrer_id ุงุฒ referral_logs
UPDATE users
SET referrer_id = (
    SELECT referral_user_id 
    FROM referral_logs 
    WHERE referral_to_id = users.user_id 
    LIMIT 1
)
WHERE user_id IN (
    SELECT DISTINCT referral_to_id 
    FROM referral_logs
);
```

---

## ๐ ูุดฺฉูุงุช ุฑุงุฌ

### ุฎุทุง: `FileNotFoundError: demo.sql`
**ุฑุงู ุญู:** ูุงู `demo.sql` ุฑุง ุฏุฑ ููุงู ุฏุงุฑฺฉุชูุฑ ฺฉู ุงุณฺฉุฑูพุช ูุณุช ูุฑุงุฑ ุฏูุฏ

### ุฎุทุง: `User not found`
**ุฑุงู ุญู:** ุงู ูุฑูุงู ุงุณุช - ุจุฑุฎ ุณุฑูุณโูุง ููฺฉู ุงุณุช ฺฉุงุฑุจุฑ ูุฑุชุจุท ูุฏุงุดุชู ุจุงุดูุฏ

### ุฎุทุง: `Plan not found`
**ุฑุงู ุญู:** ููุท ูพููโูุง ูุนุงู (`is_active=1`) ูุงฺฏุฑุช ูโุดููุฏ

### ุฎุทุง: `Invalid UUID`
**ุฑุงู ุญู:** ุงุณฺฉุฑูพุช ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉ username ุฌุงฺฏุฒู ูโุณุงุฒุฏ

---

## ๐ ุขูุงุฑ ููููู

```
๐ ุฎูุงุตู ูุงฺฏุฑุดู
==========================================================
  users: โ 445 | โ 2
  panels: โ 6 | โ 0
  plans: โ 18 | โ 0
  services: โ 1138 | โ 3
  transactions: โ 423 | โ 2

  ฺฉู ูููู: 2030
  ฺฉู ูุงูููู: 7
```

ุงฺฏุฑ ุชุนุฏุงุฏ ุฎุทุงูุง ฺฉู ุจุงุดุฏ (ฺฉูุชุฑ ุงุฒ 1%)ุ ุนุงุฏ ุงุณุช.

---

## ๐ ูพุดุชุจุงู

### ูุงู ูุงฺฏ ุฎุทุงูุง
```bash
cat migration_errors.log
```

### ุฏุณุชูุฑุงุช ุฏุจุงฺฏ
```bash
# ูุดุงูุฏู ุฌุฒุฆุงุช ุจุดุชุฑ
python migrate_old_database.py --verbose

# ุชุณุช ููุท 10 ุฑฺฉูุฑุฏ
python migrate_old_database.py --test --limit 10
```

---

## ๐ ุงููุช

- โ ูุงู `demo.sql` ุญุงู ุงุทูุงุนุงุช ุญุณุงุณ ุงุณุช
- โ ุจุนุฏ ุงุฒ ูุงฺฏุฑุดู ููููุ ุขู ุฑุง ูพุงฺฉ ฺฉูุฏ
- โ ุจฺฉุงูพโูุง ุฑุง ุฏุฑ ูฺฉุงู ุงูู ุฐุฎุฑู ฺฉูุฏ

```bash
# ูพุงฺฉ ฺฉุฑุฏู demo.sql ุจุนุฏ ุงุฒ ุงุทููุงู
rm demo.sql

# ูพุงฺฉ ฺฉุฑุฏู ูุงู ูุงฺฏ
rm migration_errors.log
```

---

## ๐ ูุณุชูุฏุงุช ฺฉุงูู

ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑุ ูุงู `MIGRATION_GUIDE.md` ุฑุง ูุทุงูุนู ฺฉูุฏ.

---

**ุขุฎุฑู ุจูโุฑูุฒุฑุณุงู:** 2025-10-19  
**ูุณุฎู:** 1.0.0  
**ุณุงุฒฺฏุงุฑ ุจุง:** MeowVPN Bot v2.0+

---

## ๐ก ูฺฉุชูโูุง ูพุงุงู

1. โฑ๏ธ **ุฒูุงู ูุงฺฏุฑุดู**: ุจุณุชู ุจู ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุงุ ููฺฉู ุงุณุช 5-30 ุฏููู ุทูู ุจฺฉุดุฏ
2. ๐ **ูุงุจู ุชฺฉุฑุงุฑ**: ูโุชูุงูุฏ ูุงฺฏุฑุดู ุฑุง ฺูุฏ ุจุงุฑ ุงุฌุฑุง ฺฉูุฏ (ุฑฺฉูุฑุฏูุง ุชฺฉุฑุงุฑ ุงุฌุงุฏ ููโุดูุฏ)
3. ๐ **ููุงุณโูพุฐุฑ**: ุจุฑุง ุฏุชุงุจุณโูุง ุจุฒุฑฺฏ (>10000 ุฑฺฉูุฑุฏ)ุ ููฺฉู ุงุณุช ูุงุฒ ุจู ุชูุธูุงุช ุงุถุงู ุจุงุดุฏ
4. ๐งช **ุชุณุช ฺฉุงูู**: ุจุนุฏ ุงุฒ ูุงฺฏุฑุดูุ ุฑุจุงุช ุฑุง ุชุณุช ฺฉูุฏ ุชุง ุงุทููุงู ุญุงุตู ุดูุฏ ููู ฺุฒ ฺฉุงุฑ ูโฺฉูุฏ

---

**ูููู ุจุงุดุฏ! ๐**

