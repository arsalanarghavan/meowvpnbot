# ๐ ุฑุงูููุง ูุตุจ ู ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ

## โก ูุตุจ ุจุง ฺฉ ุฏุณุชูุฑ!

### ุฑูุด 1: ูุตุจ ุณุฑุน (ุชูุตู ูโุดูุฏ) โญ

```bash
bash install.sh
```

**ููู!** ุงุณฺฉุฑูพุช ุฎูุฏฺฉุงุฑ ููู ฺุฒ ุฑุง ุงูุฌุงู ูโุฏูุฏ:
- โ ุจุฑุฑุณ Python ู pip
- โ ุงุฌุงุฏ virtual environment
- โ ูุตุจ dependencies
- โ ุชูุธู .env
- โ ุงุฌุฑุง migrations
- โ (ุงุฎุชุงุฑ) ุงุฌุงุฏ systemd service

---

### ุฑูุด 2: ูุตุจ ุฏุณุช

```bash
# 1. Virtual environment
python3 -m venv venv
source venv/bin/activate

# 2. Dependencies
pip install -r requirements.txt

# 3. ุชูุธูุงุช
cp .env.example .env
nano .env  # ูุฑุงุด ฺฉูุฏ

# 4. Database
alembic upgrade head

# 5. ุงุฌุฑุง
python main.py
```

---

## ๐ ุจูโุฑูุฒุฑุณุงู ุจุง ฺฉ ุฏุณุชูุฑ!

### ุงุณุชูุงุฏู ุงุฒ Updater:

```bash
bash update.sh
```

ุงู ุงุณฺฉุฑูพุช ุฎูุฏฺฉุงุฑ:
- โ ูพุดุชุจุงูโฺฏุฑ ุงุฒ ุฏุชุงุจุณ
- โ ุฏุฑุงูุช ุขุฎุฑู ูุณุฎู (git pull)
- โ ุจูโุฑูุฒุฑุณุงู dependencies
- โ ุงุฌุฑุง migrations ุฌุฏุฏ
- โ ูพุงฺฉโุณุงุฒ cache
- โ ุฑุณุชุงุฑุช ุฑุจุงุช

---

## ๐ ุฌุฒุฆุงุช ุงุณฺฉุฑูพุช Installer

### ฺู ฺฉุงุฑูุง ุงูุฌุงู ูโุฏูุฏุ

#### 1. ุจุฑุฑุณ ูพุดโูุงุฒูุง
- ุจุฑุฑุณ ูุตุจ Python 3.9+
- ุจุฑุฑุณ ูุตุจ pip
- ูุตุจ ุฎูุฏฺฉุงุฑ pip ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ

#### 2. ูุญุท ูุฌุงุฒ (Virtual Environment)
- ุงุฌุงุฏ venv ุฏุฑ ูพูุดู ูพุฑูฺู
- ูุนุงูโุณุงุฒ ุฎูุฏฺฉุงุฑ
- ุฌุฏุงุณุงุฒ dependencies

#### 3. ูุตุจ Packages
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

ุดุงูู:
- python-telegram-bot
- sqlalchemy
- alembic
- ู ุณุงุฑ dependencies

#### 4. ุชูุธู .env
- ฺฉูพ ุงุฒ .env.example
- ูพุฑุณุด ุจุฑุง ูุฑุงุด ููุฑ
- ุฑุงูููุง ุชูุธูุงุช

#### 5. Database Migration
```bash
alembic upgrade head
```

- ุงุฌุงุฏ ุชูุงู ุฌุฏุงูู
- ุงุฌุฑุง ุชูุงู migrations

#### 6. Systemd Service (ุงุฎุชุงุฑ)
- ุงุฌุงุฏ ุฎูุฏฺฉุงุฑ ูุงู service
- ูุนุงูโุณุงุฒ ุจุฑุง ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ุฏุฑ ุจูุช
- ุฑุงูููุง ุฏุณุชูุฑุงุช ูุฏุฑุช

---

## ๐ ุฌุฒุฆุงุช ุงุณฺฉุฑูพุช Updater

### ฺู ฺฉุงุฑูุง ุงูุฌุงู ูโุฏูุฏุ

#### 1. ุจุฑุฑุณ ูุถุนุช
- ุชุดุฎุต ุฑุจุงุช ุฏุฑ ุญุงู ุงุฌุฑุง
- ุชููู ุงูู ุฑุจุงุช

#### 2. ูพุดุชุจุงูโฺฏุฑ
**SQLite:**
```bash
backups/backup_20251016_120000.db
```

**PostgreSQL:**
ุฑุงูููุง ุฏุณุชูุฑ pg_dump

#### 3. Git Pull
- ุฐุฎุฑู ุชุบุฑุงุช local (git stash)
- ุฏุฑุงูุช ุขุฎุฑู ูุณุฎู
- ุจุงุฒฺฏุฑุฏุงู ุชุบุฑุงุช local

#### 4. ุจูโุฑูุฒุฑุณุงู Dependencies
```bash
pip install --upgrade -r requirements.txt
```

#### 5. Migrations ุฌุฏุฏ
```bash
alembic upgrade head
```

#### 6. ูพุงฺฉโุณุงุฒ
- ุญุฐู __pycache__
- ุญุฐู *.pyc

#### 7. ุฑุณุชุงุฑุช
- ุงุฌุฑุง ุจุง systemd ุง
- ุงุฌุฑุง ุฏุฑ background

---

## ๐ฏ ูุซุงูโูุง ุงุณุชูุงุฏู

### ูุตุจ ุงููู:

```bash
# ฺฉููู ูพุฑูฺู
git clone <repo-url> meowvpnbot
cd meowvpnbot

# ูุตุจ
bash install.sh

# ูพุงุณุฎ ุจู ุณูุงูุงุช:
# ุขุง ุงุฏุงูู ุฏูุฏ? y
# ูุฑุงุด .env ุงูุงู? y (ู ุงุทูุงุนุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ)
# ุงุฌุงุฏ systemd service? y

# ุชูุงู! ุฑุจุงุช ุขูุงุฏู ุงุณุช
```

### ุจูโุฑูุฒุฑุณุงู:

```bash
cd meowvpnbot

# ุจูโุฑูุฒุฑุณุงู
bash update.sh

# ูพุงุณุฎ ุจู ุณูุงูุงุช:
# ุขุง ุงุฏุงูู ุฏูุฏ? y
# Git pull? y
# ุงุฌุฑุง ุฑุจุงุช? y

# ุชูุงู! ุฑุจุงุช ุจูโุฑูุฒุฑุณุงู ุดุฏ
```

---

## ๐ง ุนุจโุงุจ

### ุฎุทุง: Python not found

**ุฑุงูโุญู:**
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install python3 python3-pip python3-venv

# CentOS/RHEL
sudo yum install python3 python3-pip
```

### ุฎุทุง: Permission denied

**ุฑุงูโุญู:**
```bash
# ุงุถุงูู ฺฉุฑุฏู ูุฌูุฒ ุงุฌุฑุง
chmod +x install.sh update.sh
```

### ุฎุทุง: alembic command not found

**ุฑุงูโุญู:**
```bash
# ูุนุงูโุณุงุฒ venv
source venv/bin/activate

# ูุตุจ ูุฌุฏุฏ
pip install alembic
```

### ุฎุทุง: Git conflicts

**ุฑุงูโุญู:**
```bash
# ูุดุงูุฏู ุชุบุฑุงุช
git status

# ุญู ุชุนุงุฑุถโูุง ุง
# ุฑุฏ ฺฉุฑุฏู ุชุบุฑุงุช local
git reset --hard origin/main
```

---

## โ๏ธ ุชูุธูุงุช ูพุดุฑูุชู

### ุชุบุฑ ุฒูุงู reset ฺฉุงุฑุชโูุง:

ุฏุฑ `main.py`:
```python
job_queue.run_daily(
    reset_card_daily_amounts, 
    time=time(hour=0, minute=1),  # ุชุบุฑ ุงู ุฎุท
    name='daily_card_reset'
)
```

### ุชุบุฑ ุฒูุงู ุจุฑุฑุณ ููุชูฺฉุดูโูุง:

```python
job_queue.run_daily(
    check_services_for_notifications, 
    time=time(hour=9, minute=0),  # ุชุบุฑ ุงู ุฎุท
    name='daily_notification_check'
)
```

### ุงุณุชูุงุฏู ุงุฒ PostgreSQL:

```bash
# ูุตุจ psycopg2
pip install psycopg2-binary

# ุชุบุฑ .env
DATABASE_URL=postgresql://user:pass@localhost/dbname
```

---

## ๐ ุงููุช

### ุชูุตูโูุง ููู:

#### 1. ูุญุงูุธุช ุงุฒ .env:
```bash
chmod 600 .env
```

#### 2. ุงุฌุฑุง ุจุง ฺฉุงุฑุจุฑ ุบุฑ root:
```bash
# ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงุฎุชุตุงุต
sudo useradd -m -s /bin/bash meowvpn

# ุชุบุฑ ูุงูฺฉุช
sudo chown -R meowvpn:meowvpn /path/to/meowvpnbot

# ุงุฌุฑุง
sudo -u meowvpn bash install.sh
```

#### 3. ูุงุฑูุงู:
```bash
# ููุท ูพูุฑุชโูุง ุถุฑูุฑ
sudo ufw allow 22/tcp
sudo ufw enable
```

---

## ๐ ูพุณ ุงุฒ ูุตุจ

### ฺฺฉโูุณุช:

- [ ] ุฑุจุงุช ุงุฌุฑุง ุดุฏู ู ุจุฏูู ุฎุทุงุณุช
- [ ] `/start` ุฏุฑ ุชูฺฏุฑุงู ูพุงุณุฎ ูโุฏูุฏ
- [ ] `/admin` ฺฉุงุฑ ูโฺฉูุฏ
- [ ] ูพูู Marzban ุงุถุงูู ุดุฏู
- [ ] ูพููโูุง ุงุฌุงุฏ ุดุฏู
- [ ] ฺฉุงุฑุชโูุง ุจุงูฺฉ ุงุถุงูู ุดุฏู
- [ ] ฺฉ ุฎุฑุฏ ุชุณุช ุงูุฌุงู ุดุฏู
- [ ] Systemd service ูุนุงู ุงุณุช (ุงุฎุชุงุฑ)
- [ ] Backup ุฎูุฏฺฉุงุฑ ุชูุธู ุดุฏู

### ุชุณุช ุนููฺฉุฑุฏ:

```bash
# ุจุฑุฑุณ ูุถุนุช (ุจุง systemd)
sudo systemctl status meowvpnbot

# ูุดุงูุฏู ูุงฺฏโูุง
sudo journalctl -u meowvpnbot -f

# ุง ุจุฏูู systemd
tail -f bot.log
```

---

## ๐ ุจูโุฑูุฒุฑุณุงู ููุธู

### ุชูุตู:

```bash
# ูุฑ ููุชู ฺฉุจุงุฑ
cd /path/to/meowvpnbot
bash update.sh
```

### Automation:

ุงูุฒูุฏู ุจู crontab ุจุฑุง ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ:

```bash
# ูุฑุงุด crontab
crontab -e

# ุงุถุงูู ฺฉุฑุฏู (ุจูโุฑูุฒุฑุณุงู ููุชฺฏ ุดูุจูโูุง ุณุงุนุช 4 ุตุจุญ)
0 4 * * 6 cd /path/to/meowvpnbot && bash update.sh
```

---

## ๐ ูพุดุชุจุงู

### ูุงฺฏโูุง:

```bash
# Systemd
sudo journalctl -u meowvpnbot -n 100

# Manual
tail -f bot.log

# ุฎุทุงูุง Python
python main.py  # ุงุฌุฑุง ุฏุฑ foreground ุจุฑุง ุฏุจุงฺฏ
```

### Rollback:

ุงฺฏุฑ ุจูโุฑูุฒุฑุณุงู ูุดฺฉู ุฏุงุดุช:

```bash
# 1. ุชููู ุฑุจุงุช
sudo systemctl stop meowvpnbot

# 2. ุจุงุฒฺฏุดุช ุจู ูุณุฎู ูุจู (Git)
git log --oneline -5  # ูุดุงูุฏู ุขุฎุฑู commit ูุง
git checkout <commit-hash>

# 3. ุจุงุฒฺฏุดุช migration
alembic downgrade -1

# 4. ุฑุณุชุงุฑุช
sudo systemctl start meowvpnbot
```

---

## ๐ก ูฺฉุงุช ููู

### โ ุงูุฌุงู ุฏูุฏ:

1. **ูุจู ุงุฒ ูุฑ ุจูโุฑูุฒุฑุณุงู:**
   - ูพุดุชุจุงูโฺฏุฑ (updater ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ)
   - ูุทุงูุนู CHANGELOG.md

2. **ุจุนุฏ ุงุฒ ุจูโุฑูุฒุฑุณุงู:**
   - ุชุณุช ุนููฺฉุฑุฏ ุงุตู
   - ุจุฑุฑุณ ูุงฺฏโูุง
   - ฺฉ ุฎุฑุฏ ุชุณุช

3. **ููุธู:**
   - ูพุดุชุจุงูโฺฏุฑ ููุชฺฏ
   - ุจุฑุฑุณ ูุงฺฏโูุง
   - ุจูโุฑูุฒุฑุณุงู ูุงูุงูู

### โ๏ธ ุงุฌุชูุงุจ ฺฉูุฏ:

1. **ูุตุจ ุจุฏูู virtual environment**
   - ููฺฉู ุงุณุช ุจุง packages ุณุณุชู ุชุฏุงุฎู ฺฉูุฏ

2. **ุจูโุฑูุฒุฑุณุงู ุจุฏูู ูพุดุชุจุงู**
   - ููุดู backup ุจฺฏุฑุฏ

3. **ูุงุฏุฏู ฺฏุฑูุชู ุฎุทุงูุง**
   - ูุฑ ุฎุทุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ

---

## ๐ ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ ุงุณฺฉุฑูพุชโูุง

### Installer:
- โก ุณุฑุนุช ุจุงูุง (5 ุฏููู)
- ๐ค ุฎูุฏฺฉุงุฑ 100%
- ๐ก๏ธ ุจุฏูู ุฎุทุง
- ๐ฆ ูููโฺุฒ ุขูุงุฏู
- ๐ฏ ุขูุงุฏู Production

### Updater:
- ๐ ุจูโุฑูุฒุฑุณุงู ุณุฑุน (2 ุฏููู)
- ๐พ ูพุดุชุจุงู ุฎูุฏฺฉุงุฑ
- ๐ ุงูู ู ูุทูุฆู
- ๐งน ูพุงฺฉโุณุงุฒ ุฎูุฏฺฉุงุฑ
- ๐ ุฑุณุชุงุฑุช ููุดููุฏ

---

## ๐ ูุณุชูุฏุงุช ูุฑุชุจุท

- [QUICK_START.md](QUICK_START.md) - ุดุฑูุน ุณุฑุน
- [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md) - ุฑุงูููุง ฺฉุงูู
- [README.md](README.md) - ููุง ฺฉู

---

<div align="center">

**ุจุง ุงู ุงุณฺฉุฑูพุชโูุงุ ูุตุจ ู ุจูโุฑูุฒุฑุณุงู ุจู ุณุงุฏฺฏ ุขุจ ุฎูุฑุฏู ุงุณุช! ๐**

ูุณุฎู: 2.5.0+ | ุชุงุฑุฎ: 2025-10-16

</div>

